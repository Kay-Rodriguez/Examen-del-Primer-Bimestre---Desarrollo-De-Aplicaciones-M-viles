{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/KarlaR/Downloads/movistarexamen_project/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { createClient } from '@supabase/supabase-js';\nimport * as i0 from \"@angular/core\";\nexport let SupabaseService = /*#__PURE__*/(() => {\n  class SupabaseService {\n    constructor() {\n      this.supabase = createClient('https://jgspryrvyhfkiauidfoo.supabase.co', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impnc3ByeXJ2eWhma2lhdWlkZm9vIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzOTI5MTAsImV4cCI6MjA3ODk2ODkxMH0.b5dFwDxJ7tJLd_xWPtrMcTd1zhCNoBWN6spXBzWa2mQ');\n    }\n    // ============================================================\n    // üîê AUTENTICACI√ìN\n    // ============================================================\n    signUp(nombre, email, pass, telefono) {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        // 1Ô∏è‚É£ Crear usuario en auth\n        const {\n          data,\n          error\n        } = yield _this.supabase.auth.signUp({\n          email,\n          password: pass\n        });\n        if (error) throw error;\n        const userId = data.user?.id;\n        if (!userId) throw new Error('No se pudo obtener el ID del usuario');\n        // 2Ô∏è‚É£ Esperar a que el trigger cree el perfil autom√°tico\n        // (sin esto a veces el perfil no existe todav√≠a)\n        yield new Promise(res => setTimeout(res, 500));\n        // 3Ô∏è‚É£ Actualizar el perfil creado por el trigger\n        const {\n          error: perfilError\n        } = yield _this.supabase.from('perfiles').update({\n          nombre_completo: nombre,\n          telefono: telefono\n        }).eq('id', userId);\n        if (perfilError) throw perfilError;\n        return data;\n      })();\n    }\n    signIn(email, pass) {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        const {\n          data,\n          error\n        } = yield _this2.supabase.auth.signInWithPassword({\n          email,\n          password: pass\n        });\n        if (error) throw error;\n        return data;\n      })();\n    }\n    getPerfilActual() {\n      var _this3 = this;\n      return _asyncToGenerator(function* () {\n        const {\n          data: {\n            user\n          }\n        } = yield _this3.supabase.auth.getUser();\n        if (!user) return null;\n        const {\n          data\n        } = yield _this3.supabase.from('perfiles').select('*').eq('id', user.id).single();\n        return data;\n      })();\n    }\n    logout() {\n      return this.supabase.auth.signOut();\n    }\n    static {\n      this.…µfac = function SupabaseService_Factory(t) {\n        return new (t || SupabaseService)();\n      };\n    }\n    static {\n      this.…µprov = /*@__PURE__*/i0.…µ…µdefineInjectable({\n        token: SupabaseService,\n        factory: SupabaseService.…µfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return SupabaseService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}