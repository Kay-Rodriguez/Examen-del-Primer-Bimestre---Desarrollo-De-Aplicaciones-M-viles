{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/KarlaR/Downloads/movistarexamen_project/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nlet ChatsPage = class ChatsPage {\n  constructor(supabaseSvc) {\n    this.supabaseSvc = supabaseSvc;\n    this.contratos = [];\n    this.seleccionado = null;\n    this.mensajes = [];\n    this.nuevoMensaje = '';\n    this.canal = null;\n  }\n  ngOnInit() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      yield _this.cargarContratos();\n    })();\n  }\n  ngOnDestroy() {\n    if (this.canal) {\n      this.canal.unsubscribe();\n    }\n  }\n  cargarContratos() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      _this2.contratos = yield _this2.supabaseSvc.misContratos();\n    })();\n  }\n  abrirChat(c) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      _this3.seleccionado = c;\n      _this3.mensajes = yield _this3.supabaseSvc.obtenerMensajes(c.id);\n      if (_this3.canal) {\n        _this3.canal.unsubscribe();\n      }\n      _this3.canal = _this3.supabaseSvc.escucharChat(c.id, msg => {\n        _this3.mensajes = [..._this3.mensajes, msg];\n      });\n    })();\n  }\n  enviar() {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this4.nuevoMensaje.trim() || !_this4.seleccionado) return;\n      yield _this4.supabaseSvc.enviarMensaje(_this4.seleccionado.id, _this4.nuevoMensaje.trim());\n      _this4.nuevoMensaje = '';\n    })();\n  }\n};\nChatsPage = __decorate([Component({\n  selector: 'app-chats-usuario',\n  templateUrl: './chats.page.html',\n  styleUrls: ['./chats.page.scss']\n})], ChatsPage);\nexport { ChatsPage };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}