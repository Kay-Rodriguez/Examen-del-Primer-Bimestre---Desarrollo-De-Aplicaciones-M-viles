{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/KarlaR/Downloads/movistarexamen_project/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nlet DashboardPage = class DashboardPage {\n  constructor(supabaseSvc, pri) {\n    this.supabaseSvc = supabaseSvc;\n    this.planes = [];\n    this.cargando = false;\n    // Formulario crear/editar\n    this.mostrarForm = false;\n    this.editando = false;\n    this.planActual = this.nuevoPlanModelo();\n    this.imagenFile = null;\n  }\n  ngOnInit() {\n    this.cargarPlanes();\n  }\n  ionViewWillEnter() {\n    this.cargarPlanes();\n  }\n  nuevoPlanModelo() {\n    return {\n      id: null,\n      nombre: '',\n      precio_mensual: null,\n      gb_datos: null,\n      minutos: null,\n      descripcion: '',\n      promocion: '',\n      imagen_url: '',\n      segmento: '',\n      publico_objetivo: '',\n      activo: true\n    };\n  }\n  cargarPlanes() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      _this.cargando = true;\n      _this.planes = yield _this.supabaseSvc.getPlanesPublicosAsesor();\n      _this.cargando = false;\n    })();\n  }\n  // Abrir formulario en modo crear\n  abrirCrear() {\n    this.editando = false;\n    this.planActual = this.nuevoPlanModelo();\n    this.imagenFile = null;\n    this.mostrarForm = true;\n  }\n  // Abrir formulario en modo editar\n  abrirEditar(plan) {\n    this.editando = true;\n    this.planActual = {\n      ...plan\n    };\n    this.imagenFile = null;\n    this.mostrarForm = true;\n  }\n  cerrarForm() {\n    this.mostrarForm = false;\n  }\n  onFileChange(event) {\n    const file = event.target.files[0];\n    if (file) {\n      this.imagenFile = file;\n    }\n  }\n  guardarPlan() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      try {\n        // Subir imagen si se seleccionó\n        if (_this2.imagenFile) {\n          const url = yield _this2.supabaseSvc.uploadImage(_this2.imagenFile);\n          _this2.planActual.imagen_url = url;\n        }\n        if (_this2.editando && _this2.planActual.id) {\n          yield _this2.supabaseSvc.editarPlan(_this2.planActual.id, _this2.planActual);\n        } else {\n          yield _this2.supabaseSvc.crearPlan(_this2.planActual);\n        }\n        _this2.cerrarForm();\n        yield _this2.cargarPlanes();\n      } catch (err) {\n        console.error(err);\n      }\n    })();\n  }\n  eliminar(plan) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      if (!confirm('¿Eliminar este plan?')) return;\n      yield _this3.supabaseSvc.eliminarPlan(plan.id);\n      yield _this3.cargarPlanes();\n    })();\n  }\n  // Cambiar estado activo/inactivo\n  toggleActivo(plan) {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      yield _this4.supabaseSvc.editarPlan(plan.id, {\n        activo: !plan.activo\n      });\n      yield _this4.cargarPlanes();\n    })();\n  }\n};\nDashboardPage = __decorate([Component({\n  selector: 'app-dashboard',\n  templateUrl: './dashboard.page.html',\n  styleUrls: ['./dashboard.page.scss']\n})], DashboardPage);\nexport { DashboardPage };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}