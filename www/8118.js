"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8118],{8118:(F,d,r)=>{r.r(d),r.d(d,{DashboardPageModule:()=>C});var g=r(177),c=r(4341),l=r(8974),m=r(70),p=r(467),n=r(4438),u=r(9593);function _(i,s){1&i&&n.nrm(0,"ion-spinner",8)}function h(i,s){if(1&i&&(n.j41(0,"p"),n.nrm(1,"ion-icon",28),n.EFF(2),n.k0s()),2&i){const e=n.XpG().$implicit;n.R7$(2),n.SpI(" ",e.promocion,"")}}function b(i,s){if(1&i&&(n.j41(0,"div",29),n.nrm(1,"img",30),n.k0s()),2&i){const e=n.XpG().$implicit;n.R7$(),n.Y8G("src",e.imagen_url,n.B4B)}}function f(i,s){if(1&i){const e=n.RV6();n.j41(0,"ion-card",9)(1,"div",10)(2,"div")(3,"h3"),n.EFF(4),n.k0s(),n.j41(5,"p",11),n.EFF(6),n.k0s()(),n.j41(7,"div",12)(8,"span"),n.EFF(9),n.k0s(),n.j41(10,"small"),n.EFF(11,"/mes"),n.k0s()()(),n.j41(12,"div",13)(13,"div",14)(14,"p"),n.nrm(15,"ion-icon",15),n.EFF(16),n.k0s(),n.j41(17,"p"),n.nrm(18,"ion-icon",16),n.EFF(19),n.k0s(),n.DNE(20,h,3,1,"p",17),n.k0s(),n.DNE(21,b,2,1,"div",18),n.k0s(),n.j41(22,"p",19),n.EFF(23),n.k0s(),n.j41(24,"div",20)(25,"ion-chip",21),n.bIt("click",function(){const t=n.eBV(e).$implicit,o=n.XpG();return n.Njj(o.toggleActivo(t))}),n.nrm(26,"ion-icon",22),n.j41(27,"ion-label"),n.EFF(28),n.k0s()(),n.j41(29,"div",23)(30,"ion-button",24),n.bIt("click",function(){const t=n.eBV(e).$implicit,o=n.XpG();return n.Njj(o.abrirEditar(t))}),n.nrm(31,"ion-icon",25),n.EFF(32," Editar "),n.k0s(),n.j41(33,"ion-button",26),n.bIt("click",function(){const t=n.eBV(e).$implicit,o=n.XpG();return n.Njj(o.eliminar(t))}),n.nrm(34,"ion-icon",27),n.EFF(35," Eliminar "),n.k0s()()()()}if(2&i){const e=s.$implicit;n.R7$(4),n.JRh(e.nombre),n.R7$(2),n.JRh(e.segmento),n.R7$(3),n.SpI("$",e.precio_mensual,""),n.R7$(7),n.SpI(" ",e.gb_datos," GB datos"),n.R7$(3),n.SpI(" ",e.minutos," min nacionales"),n.R7$(),n.Y8G("ngIf",e.promocion),n.R7$(),n.Y8G("ngIf",e.imagen_url),n.R7$(2),n.JRh(e.descripcion),n.R7$(2),n.Y8G("color",e.activo?"success":"medium"),n.R7$(),n.Y8G("name",e.activo?"checkmark-circle":"close-circle"),n.R7$(2),n.JRh(e.activo?"Activo":"Inactivo")}}function P(i,s){if(1&i){const e=n.RV6();n.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),n.EFF(3),n.k0s(),n.j41(4,"ion-buttons",31)(5,"ion-button",32),n.bIt("click",function(){n.eBV(e);const t=n.XpG();return n.Njj(t.cerrarForm())}),n.EFF(6,"Cerrar"),n.k0s()()()(),n.j41(7,"ion-content",1)(8,"form",33),n.bIt("ngSubmit",function(){n.eBV(e);const t=n.XpG();return n.Njj(t.guardarPlan())}),n.j41(9,"ion-item")(10,"ion-label",34),n.EFF(11,"Nombre del Plan"),n.k0s(),n.j41(12,"ion-input",35),n.mxI("ngModelChange",function(t){n.eBV(e);const o=n.XpG();return n.DH7(o.planActual.nombre,t)||(o.planActual.nombre=t),n.Njj(t)}),n.k0s()(),n.j41(13,"ion-item")(14,"ion-label",34),n.EFF(15,"Precio mensual ($)"),n.k0s(),n.j41(16,"ion-input",36),n.mxI("ngModelChange",function(t){n.eBV(e);const o=n.XpG();return n.DH7(o.planActual.precio_mensual,t)||(o.planActual.precio_mensual=t),n.Njj(t)}),n.k0s()(),n.j41(17,"ion-item")(18,"ion-label",34),n.EFF(19,"GB de datos"),n.k0s(),n.j41(20,"ion-input",37),n.mxI("ngModelChange",function(t){n.eBV(e);const o=n.XpG();return n.DH7(o.planActual.gb_datos,t)||(o.planActual.gb_datos=t),n.Njj(t)}),n.k0s()(),n.j41(21,"ion-item")(22,"ion-label",34),n.EFF(23,"Minutos"),n.k0s(),n.j41(24,"ion-input",38),n.mxI("ngModelChange",function(t){n.eBV(e);const o=n.XpG();return n.DH7(o.planActual.minutos,t)||(o.planActual.minutos=t),n.Njj(t)}),n.k0s()(),n.j41(25,"ion-item")(26,"ion-label",34),n.EFF(27,"Segmento"),n.k0s(),n.j41(28,"ion-input",39),n.mxI("ngModelChange",function(t){n.eBV(e);const o=n.XpG();return n.DH7(o.planActual.segmento,t)||(o.planActual.segmento=t),n.Njj(t)}),n.k0s()(),n.j41(29,"ion-item")(30,"ion-label",34),n.EFF(31,"P\xfablico objetivo"),n.k0s(),n.j41(32,"ion-input",40),n.mxI("ngModelChange",function(t){n.eBV(e);const o=n.XpG();return n.DH7(o.planActual.publico_objetivo,t)||(o.planActual.publico_objetivo=t),n.Njj(t)}),n.k0s()(),n.j41(33,"ion-item")(34,"ion-label",34),n.EFF(35,"Descripci\xf3n"),n.k0s(),n.j41(36,"ion-textarea",41),n.mxI("ngModelChange",function(t){n.eBV(e);const o=n.XpG();return n.DH7(o.planActual.descripcion,t)||(o.planActual.descripcion=t),n.Njj(t)}),n.k0s()(),n.j41(37,"ion-item")(38,"ion-label",34),n.EFF(39,"Promoci\xf3n (opcional)"),n.k0s(),n.j41(40,"ion-input",42),n.mxI("ngModelChange",function(t){n.eBV(e);const o=n.XpG();return n.DH7(o.planActual.promocion,t)||(o.planActual.promocion=t),n.Njj(t)}),n.k0s()(),n.j41(41,"ion-item")(42,"ion-label",34),n.EFF(43,"Imagen del plan"),n.k0s(),n.j41(44,"input",43),n.bIt("change",function(t){n.eBV(e);const o=n.XpG();return n.Njj(o.onFileChange(t))}),n.k0s()(),n.j41(45,"ion-button",44),n.EFF(46),n.k0s()()()}if(2&i){const e=n.XpG();n.R7$(3),n.JRh(e.editando?"Editar Plan":"Crear Nuevo Plan"),n.R7$(9),n.R50("ngModel",e.planActual.nombre),n.R7$(4),n.R50("ngModel",e.planActual.precio_mensual),n.R7$(4),n.R50("ngModel",e.planActual.gb_datos),n.R7$(4),n.R50("ngModel",e.planActual.minutos),n.R7$(4),n.R50("ngModel",e.planActual.segmento),n.R7$(4),n.R50("ngModel",e.planActual.publico_objetivo),n.R7$(4),n.R50("ngModel",e.planActual.descripcion),n.R7$(4),n.R50("ngModel",e.planActual.promocion),n.R7$(6),n.SpI(" ",e.editando?"Actualizar plan":"Crear plan"," ")}}const M=[{path:"",component:(()=>{class i{constructor(e,a){this.supabaseSvc=e,this.toastCtrl=a,this.planes=[],this.cargando=!1,this.mostrarForm=!1,this.editando=!1,this.planActual=this.nuevoPlanModelo(),this.imagenFile=null}ngOnInit(){this.cargarPlanes()}ionViewWillEnter(){this.cargarPlanes()}nuevoPlanModelo(){return{id:null,nombre:"",precio_mensual:null,gb_datos:null,minutos:null,descripcion:"",promocion:"",imagen_url:"",segmento:"",publico_objetivo:"",activo:!0}}cargarPlanes(){var e=this;return(0,p.A)(function*(){e.cargando=!0,e.planes=yield e.supabaseSvc.getPlanesPublicosAsesor(),e.cargando=!1})()}abrirCrear(){this.editando=!1,this.planActual=this.nuevoPlanModelo(),this.imagenFile=null,this.mostrarForm=!0}abrirEditar(e){this.editando=!0,this.planActual={...e},this.imagenFile=null,this.mostrarForm=!0}cerrarForm(){this.mostrarForm=!1}onFileChange(e){const a=e.target.files[0];a&&(this.imagenFile=a)}guardarPlan(){var e=this;return(0,p.A)(function*(){try{let a={...e.planActual};if(e.imagenFile){const o=yield e.supabaseSvc.uploadImage(e.imagenFile);a.imagen_url=o}e.editando?yield e.supabaseSvc.editarPlan(a.id,a):(delete a.id,yield e.supabaseSvc.crearPlan(a)),(yield e.toastCtrl.create({message:e.editando?"Plan actualizado correctamente":"Plan creado correctamente",color:"success",duration:2e3})).present(),e.cerrarForm(),e.cargarPlanes()}catch(a){console.error(a),(yield e.toastCtrl.create({message:"No se pudo guardar el plan",color:"danger",duration:2e3})).present()}})()}eliminar(e){var a=this;return(0,p.A)(function*(){confirm("\xbfEliminar este plan?")&&(yield a.supabaseSvc.eliminarPlan(e.id),yield a.cargarPlanes())})()}toggleActivo(e){var a=this;return(0,p.A)(function*(){yield a.supabaseSvc.editarPlan(e.id,{activo:!e.activo}),yield a.cargarPlanes()})()}static{this.\u0275fac=function(a){return new(a||i)(n.rXU(u.w),n.rXU(l.K_))}}static{this.\u0275cmp=n.VBU({type:i,selectors:[["app-dashboard"]],decls:18,vars:3,consts:[[1,"header-gradient"],[1,"ion-padding"],[1,"panel-header"],["fill","solid",1,"btn-crear",3,"click"],["name","add-circle-outline","slot","start"],["name","crescent",4,"ngIf"],["class","card-plan",4,"ngFor","ngForOf"],[3,"didDismiss","isOpen"],["name","crescent"],[1,"card-plan"],[1,"plan-header"],[1,"segmento"],[1,"precio"],[1,"plan-body"],[1,"info"],["name","cellular-outline"],["name","call-outline"],[4,"ngIf"],["class","imagen",4,"ngIf"],[1,"descripcion"],[1,"acciones"],[3,"click","color"],[3,"name"],[1,"acciones-botones"],["fill","outline","size","small",3,"click"],["slot","start","name","create-outline"],["color","danger","size","small",3,"click"],["slot","start","name","trash-outline"],["name","sparkles-outline"],[1,"imagen"],["alt","imagen plan",3,"src"],["slot","end"],[3,"click"],[3,"ngSubmit"],["position","stacked"],["name","nombre","required","",3,"ngModelChange","ngModel"],["type","number","name","precio","required","",3,"ngModelChange","ngModel"],["type","number","name","gb_datos","required","",3,"ngModelChange","ngModel"],["type","number","name","minutos","required","",3,"ngModelChange","ngModel"],["name","segmento",3,"ngModelChange","ngModel"],["name","publico",3,"ngModelChange","ngModel"],["name","descripcion",3,"ngModelChange","ngModel"],["name","promocion",3,"ngModelChange","ngModel"],["type","file","accept","image/*",3,"change"],["expand","block","type","submit",1,"btn-guardar"]],template:function(a,t){1&a&&(n.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),n.EFF(3,"Panel de Asesor"),n.k0s()()(),n.j41(4,"ion-content",1)(5,"div",2)(6,"div")(7,"h2"),n.EFF(8,"Gesti\xf3n de Planes"),n.k0s(),n.j41(9,"p"),n.EFF(10,"Administra el cat\xe1logo de planes m\xf3viles Tigo Conecta."),n.k0s()(),n.j41(11,"ion-button",3),n.bIt("click",function(){return t.abrirCrear()}),n.nrm(12,"ion-icon",4),n.EFF(13," Crear nuevo plan "),n.k0s()(),n.DNE(14,_,1,0,"ion-spinner",5)(15,f,36,11,"ion-card",6),n.j41(16,"ion-modal",7),n.bIt("didDismiss",function(){return t.cerrarForm()}),n.DNE(17,P,47,10,"ng-template"),n.k0s()()),2&a&&(n.R7$(14),n.Y8G("ngIf",t.cargando),n.R7$(),n.Y8G("ngForOf",t.planes),n.R7$(),n.Y8G("isOpen",t.mostrarForm))},dependencies:[g.Sq,g.bT,c.qT,c.BC,c.cb,c.YS,c.vS,c.cV,l.Jm,l.QW,l.b_,l.ZB,l.W9,l.eU,l.iq,l.$w,l.uz,l.he,l.w2,l.nc,l.BC,l.ai,l.Sb,l.su,l.Gw],styles:[".header-gradient[_ngcontent-%COMP%]{--background: linear-gradient(90deg, #0033a0, #673ab7);--color: #ffffff}.panel-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:18px}.panel-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:22px;font-weight:700;margin:0}.panel-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0 0;font-size:14px;color:#666}.btn-crear[_ngcontent-%COMP%]{--background: linear-gradient(90deg, #00c0ff, #0080ff);--border-radius: 999px;font-weight:600}.card-plan[_ngcontent-%COMP%]{border-radius:18px;box-shadow:0 8px 20px #00000014;margin-bottom:16px}.plan-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px}.plan-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:700}.plan-header[_ngcontent-%COMP%]   .segmento[_ngcontent-%COMP%]{margin:4px 0 0;font-size:13px;color:#777}.plan-header[_ngcontent-%COMP%]   .precio[_ngcontent-%COMP%]{text-align:right}.plan-header[_ngcontent-%COMP%]   .precio[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:22px;font-weight:800;color:#0033a0}.plan-header[_ngcontent-%COMP%]   .precio[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{display:block;font-size:12px;color:#777}.plan-body[_ngcontent-%COMP%]{display:flex;padding:0 16px 10px}.plan-body[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{flex:2}.plan-body[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;margin:4px 0}.plan-body[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:6px;vertical-align:middle}.plan-body[_ngcontent-%COMP%]   .imagen[_ngcontent-%COMP%]{flex:1;display:flex;justify-content:flex-end}.plan-body[_ngcontent-%COMP%]   .imagen[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:90px;height:90px;border-radius:16px;object-fit:cover}.descripcion[_ngcontent-%COMP%]{padding:0 16px 10px;font-size:13px;color:#555}.acciones[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:0 16px 14px}.acciones[_ngcontent-%COMP%]   .acciones-botones[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-guardar[_ngcontent-%COMP%]{margin-top:24px;--background: linear-gradient(90deg, #0033a0, #673ab7);--border-radius: 16px;font-weight:600}"]})}}return i})()}];let C=(()=>{class i{static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275mod=n.$C({type:i})}static{this.\u0275inj=n.G2t({imports:[g.MD,c.YN,l.bv,m.iI.forChild(M)]})}}return i})()}}]);